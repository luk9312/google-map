import * as functions from 'firebase-functions';
import * as express from 'express';
import * as gmap from '@google/maps';
import * as cors from 'cors';
import * as bodyParser from 'body-parser';

let testingData =[
  [{lat: 43.96615480477465, lng: -81.18443079990305},{lat: 43.972738344811845, lng: -79.95473707648978}],
  [{lat: 43.96166322835406, lng: -81.18443079990305},{lat: 43.96824676839124, lng: -79.95473707648978}],
  [{lat: 43.95717165193346, lng: -81.18443079990305},{lat: 43.96375519197065, lng: -79.95473707648978}],
  [{lat: 43.95268007551286, lng: -81.18443079990305},{lat: 43.95926361555004, lng: -79.95473707648978}],
  [{lat: 43.948188499092254, lng: -81.18443079990305},{lat: 43.954772039129445, lng: -79.95473707648978}],
  [{lat: 43.94369692267167, lng: -81.18443079990305},{lat: 43.950280462708854, lng: -79.95473707648978}],
  [{lat: 43.939205346251065, lng: -81.18443079990305},{lat: 43.945788886288256, lng: -79.95473707648978}],
  [{lat: 43.934713769830466, lng: -81.18443079990305},{lat: 43.94129730986766, lng: -79.95473707648978}],
  [{lat: 43.93022219340986, lng: -81.18443079990305},{lat: 43.93680573344705, lng: -79.95473707648978}],
  [{lat: 43.92573061698928, lng: -81.18443079990305},{lat: 43.93231415702647, lng: -79.95473707648978}],
  [{lat: 43.92123904056867, lng: -81.18443079990305},{lat: 43.92782258060586, lng: -79.95473707648978}],
  [{lat: 43.91674746414808, lng: -81.18443079990305},{lat: 43.923331004185265, lng: -79.95473707648978}],
  [{lat: 43.91225588772748, lng: -81.18443079990305},{lat: 43.91883942776467, lng: -79.95473707648978}],
  [{lat: 43.90776431130689, lng: -81.18443079990305},{lat: 43.91434785134408, lng: -79.95473707648978}],
  [{lat: 43.90327273488627, lng: -81.18443079990305},{lat: 43.90985627492348, lng: -79.95473707648978}],
  [{lat: 43.89878115846569, lng: -81.18443079990305},{lat: 43.90536469850287, lng: -79.95473707648978}],
  [{lat: 43.89428958204509, lng: -81.18443079990305},{lat: 43.90087312208228, lng: -79.95473707648978}],
  [{lat: 43.889798005624485, lng: -81.18443079990305},{lat: 43.89638154566168, lng: -79.95473707648978}],
  [{lat: 43.88530642920389, lng: -81.18443079990305},{lat: 43.89188996924108, lng: -79.95473707648978}],
  [{lat: 43.8808148527833, lng: -81.18443079990305},{lat: 43.88739839282049, lng: -79.95473707648978}],
  [{lat: 43.8763232763627, lng: -81.18443079990305},{lat: 43.882906816399895, lng: -79.95473707648978}],
  [{lat: 43.871831699942106, lng: -81.18443079990305},{lat: 43.87841523997929, lng: -79.95473707648978}],
  [{lat: 43.8673401235215, lng: -81.18443079990305},{lat: 43.873923663558685, lng: -79.95473707648978}],
  [{lat: 43.8628485471009, lng: -81.18443079990305},{lat: 43.869432087138094, lng: -79.95473707648978}],
  [{lat: 43.85835697068032, lng: -81.18443079990305},{lat: 43.8649405107175, lng: -79.95473707648978}],
  [{lat: 43.853865394259714, lng: -81.18443079990305},{lat: 43.8604489342969, lng: -79.95473707648978}],
  [{lat: 43.849373817839115, lng: -81.18443079990305},{lat: 43.85595735787629, lng: -79.95473707648978}],
  [{lat: 43.84488224141851, lng: -81.18443079990305},{lat: 43.8514657814557, lng: -79.95473707648978}],
  [{lat: 43.84039066499791, lng: -81.18443079990305},{lat: 43.8469742050351, lng: -79.95473707648978}],
  [{lat: 43.83589908857732, lng: -81.18443079990305},{lat: 43.84248262861451, lng: -79.95473707648978}],
  [{lat: 43.83140751215672, lng: -81.18443079990305},{lat: 43.837991052193914, lng: -79.95473707648978}],
  [{lat: 43.82691593573612, lng: -81.18443079990305},{lat: 43.83349947577331, lng: -79.95473707648978}],
  [{lat: 43.82242435931552, lng: -81.18443079990305},{lat: 43.82900789935271, lng: -79.95473707648978}],
  [{lat: 43.817932782894935, lng: -81.18443079990305},{lat: 43.82451632293211, lng: -79.95473707648978}],
  [{lat: 43.81344120647433, lng: -81.18443079990305},{lat: 43.82002474651152, lng: -79.95473707648978}],
  [{lat: 43.80894963005374, lng: -81.18443079990305},{lat: 43.81553317009092, lng: -79.95473707648978}],
  [{lat: 43.804458053633134, lng: -81.18443079990305},{lat: 43.811041593670325, lng: -79.95473707648978}],
  [{lat: 43.799966477212536, lng: -81.18443079990305},{lat: 43.80655001724973, lng: -79.95473707648978}],
  [{lat: 43.795474900791945, lng: -81.18443079990305},{lat: 43.80205844082912, lng: -79.95473707648978}],
  [{lat: 43.790983324371346, lng: -81.18443079990305},{lat: 43.79756686440854, lng: -79.95473707648978}],
  [{lat: 43.78649174795074, lng: -81.18443079990305},{lat: 43.79307528798793, lng: -79.95473707648978}],
  [{lat: 43.78200017153014, lng: -81.18443079990305},{lat: 43.78858371156734, lng: -79.95473707648978}],
  [{lat: 43.777508595109545, lng: -81.18443079990305},{lat: 43.784092135146736, lng: -79.95473707648978}],
  [{lat: 43.773017018688954, lng: -81.18443079990305},{lat: 43.77960055872615, lng: -79.95473707648978}],
  [{lat: 43.76852544226836, lng: -81.18443079990305},{lat: 43.77510898230555, lng: -79.95473707648978}],
  [{lat: 43.764033865847765, lng: -81.18443079990305},{lat: 43.77061740588495, lng: -79.95473707648978}],
  [{lat: 43.75954228942716, lng: -81.18443079990305},{lat: 43.766125829464364, lng: -79.95473707648978}],
  [{lat: 43.75505071300657, lng: -81.18443079990305},{lat: 43.761634253043745, lng: -79.95473707648978}],
  [{lat: 43.75055913658595, lng: -81.18443079990305},{lat: 43.75714267662316, lng: -79.95473707648978}],
  [{lat: 43.74606756016537, lng: -81.18443079990305},{lat: 43.752651100202556, lng: -79.95473707648978}],
  [{lat: 43.74157598374477, lng: -81.18443079990305},{lat: 43.74815952378196, lng: -79.95473707648978}],
  [{lat: 43.73708440732417, lng: -81.18443079990305},{lat: 43.74366794736136, lng: -79.95473707648978}],
  [{lat: 43.732592830903585, lng: -81.18443079990305},{lat: 43.73917637094076, lng: -79.95473707648978}],
  [{lat: 43.72810125448298, lng: -81.18443079990305},{lat: 43.73468479452017, lng: -79.95473707648978}],
  [{lat: 43.72360967806238, lng: -81.18443079990305},{lat: 43.73019321809957, lng: -79.95473707648978}],
  [{lat: 43.719118101641776, lng: -81.18443079990305},{lat: 43.725701641678974, lng: -79.95473707648978}],
  [{lat: 43.714626525221185, lng: -81.18443079990305},{lat: 43.72121006525837, lng: -79.95473707648978}],
  [{lat: 43.710134948800594, lng: -81.18443079990305},{lat: 43.716718488837785, lng: -79.95473707648978}],
  [{lat: 43.705643372379974, lng: -81.18443079990305},{lat: 43.71222691241718, lng: -79.95473707648978}],
  [{lat: 43.7011517959594, lng: -81.18443079990305},{lat: 43.70773533599659, lng: -79.95473707648978}],
  [{lat: 43.69666021953879, lng: -81.18443079990305},{lat: 43.70324375957598, lng: -79.95473707648978}],
  [{lat: 43.692168643118194, lng: -81.18443079990305},{lat: 43.698752183155385, lng: -79.95473707648978}],
  [{lat: 43.6876770666976, lng: -81.18443079990305},{lat: 43.694260606734794, lng: -79.95473707648978}],
  [{lat: 43.683185490277005, lng: -81.18443079990305},{lat: 43.68976903031419, lng: -79.95473707648978}],
  [{lat: 43.6786939138564, lng: -81.18443079990305},{lat: 43.68527745389359, lng: -79.95473707648978}],
  [{lat: 43.674202337435794, lng: -81.18443079990305},{lat: 43.68078587747299, lng: -79.95473707648978}],
  [{lat: 43.6697107610152, lng: -81.18443079990305},{lat: 43.676294301052394, lng: -79.95473707648978}],
  [{lat: 43.66521918459461, lng: -81.18443079990305},{lat: 43.6718027246318, lng: -79.95473707648978}],
  [{lat: 43.66072760817401, lng: -81.18443079990305},{lat: 43.6673111482112, lng: -79.95473707648978}],
  [{lat: 43.65623603175341, lng: -81.18443079990305},{lat: 43.6628195717906, lng: -79.95473707648978}],
  [{lat: 43.65174445533281, lng: -81.18443079990305},{lat: 43.65832799537001, lng: -79.95473707648978}],
  [{lat: 43.64725287891223, lng: -81.18443079990305},{lat: 43.6538364189494, lng: -79.95473707648978}],
  [{lat: 43.64276130249162, lng: -81.18443079990305},{lat: 43.64934484252881, lng: -79.95473707648978}],
  [{lat: 43.63826972607102, lng: -81.18443079990305},{lat: 43.644853266108214, lng: -79.95473707648978}],
  [{lat: 43.633778149650425, lng: -81.18443079990305},{lat: 43.640361689687616, lng: -79.95473707648978}],
  [{lat: 43.62928657322983, lng: -81.18443079990305},{lat: 43.63587011326702, lng: -79.95473707648978}],
  [{lat: 43.624794996809236, lng: -81.18443079990305},{lat: 43.63137853684643, lng: -79.95473707648978}],
  [{lat: 43.62030342038863, lng: -81.18443079990305},{lat: 43.62688696042583, lng: -79.95473707648978}],
  [{lat: 43.61581184396803, lng: -81.18443079990305},{lat: 43.62239538400522, lng: -79.95473707648978}],
  [{lat: 43.61132026754744, lng: -81.18443079990305},{lat: 43.61790380758463, lng: -79.95473707648978}],
  [{lat: 43.606828691126836, lng: -81.18443079990305},{lat: 43.61341223116403, lng: -79.95473707648978}],
  [{lat: 43.60233711470624, lng: -81.18443079990305},{lat: 43.60892065474344, lng: -79.95473707648978}],
  [{lat: 43.59784553828563, lng: -81.18443079990305},{lat: 43.60442907832282, lng: -79.95473707648978}],
  [{lat: 43.59335396186505, lng: -81.18443079990305},{lat: 43.59993750190225, lng: -79.95473707648978}],
  [{lat: 43.58886238544444, lng: -81.18443079990305},{lat: 43.59544592548164, lng: -79.95473707648978}],
  [{lat: 43.58437080902385, lng: -81.18443079990305},{lat: 43.59095434906104, lng: -79.95473707648978}],
  [{lat: 43.57987923260326, lng: -81.18443079990305},{lat: 43.58646277264045, lng: -79.95473707648978}],
  [{lat: 43.57538765618266, lng: -81.18443079990305},{lat: 43.58197119621985, lng: -79.95473707648978}],
  [{lat: 43.57089607976206, lng: -81.18443079990305},{lat: 43.57747961979925, lng: -79.95473707648978}],
  [{lat: 43.56640450334146, lng: -81.18443079990305},{lat: 43.57298804337864, lng: -79.95473707648978}],
  [{lat: 43.56191292692086, lng: -81.18443079990305},{lat: 43.56849646695805, lng: -79.95473707648978}],
  [{lat: 43.557421350500256, lng: -81.18443079990305},{lat: 43.56400489053746, lng: -79.95473707648978}],
  [{lat: 43.552929774079665, lng: -81.18443079990305},{lat: 43.55951331411686, lng: -79.95473707648978}],
  [{lat: 43.548438197659074, lng: -81.18443079990305},{lat: 43.555021737696265, lng: -79.95473707648978}],
  [{lat: 43.54394662123847, lng: -81.18443079990305},{lat: 43.55053016127566, lng: -79.95473707648978}],
  [{lat: 43.53945504481786, lng: -81.18443079990305},{lat: 43.546038584855076, lng: -79.95473707648978}],
  [{lat: 43.53496346839728, lng: -81.18443079990305},{lat: 43.54154700843448, lng: -79.95473707648978}],
  [{lat: 43.53047189197668, lng: -81.18443079990305},{lat: 43.53705543201387, lng: -79.95473707648978}],
  [{lat: 43.525980315556076, lng: -81.18443079990305},{lat: 43.53256385559328, lng: -79.95473707648978}],
  [{lat: 43.52148873913547, lng: -81.18443079990305},{lat: 43.52807227917267, lng: -79.95473707648978}],
  [{lat: 43.51699716271488, lng: -81.18443079990305},{lat: 43.523580702752085, lng: -79.95473707648978}],
  [{lat: 43.51250558629429, lng: -81.18443079990305},{lat: 43.51908912633148, lng: -79.95473707648978}],
  [{lat: 43.50801400987369, lng: -81.18443079990305},{lat: 43.51459754991088, lng: -79.95473707648978}],
  [{lat: 43.50352243345309, lng: -81.18443079990305},{lat: 43.51010597349028, lng: -79.95473707648978}],
  [{lat: 43.499030857032494, lng: -81.18443079990305},{lat: 43.505614397069685, lng: -79.95473707648978}],
  [{lat: 43.49453928061189, lng: -81.18443079990305},{lat: 43.501122820649094, lng: -79.95473707648978}],
  [{lat: 43.490047704191305, lng: -81.18443079990305},{lat: 43.496631244228496, lng: -79.95473707648978}],
  [{lat: 43.4855561277707, lng: -81.18443079990305},{lat: 43.4921396678079, lng: -79.95473707648978}],
  [{lat: 43.481064551350094, lng: -81.18443079990305},{lat: 43.4876480913873, lng: -79.95473707648978}],
  [{lat: 43.4765729749295, lng: -81.18443079990305},{lat: 43.483156514966694, lng: -79.95473707648978}],
  [{lat: 43.472081398508905, lng: -81.18443079990305},{lat: 43.47866493854611, lng: -79.95473707648978}],
  [{lat: 43.4675898220883, lng: -81.18443079990305},{lat: 43.474173362125505, lng: -79.95473707648978}],
  [{lat: 43.463098245667716, lng: -81.18443079990305},{lat: 43.46968178570491, lng: -79.95473707648978}],
  [{lat: 43.45860666924711, lng: -81.18443079990305},{lat: 43.4651902092843, lng: -79.95473707648978}],
  [{lat: 43.45411509282651, lng: -81.18443079990305},{lat: 43.46069863286371, lng: -79.95473707648978}],
  [{lat: 43.449623516405914, lng: -81.18443079990305},{lat: 43.45620705644312, lng: -79.95473707648978}],
  [{lat: 43.44513193998532, lng: -81.18443079990305},{lat: 43.45171548002252, lng: -79.95473707648978}],
  [{lat: 43.440640363564725, lng: -81.18443079990305},{lat: 43.44722390360192, lng: -79.95473707648978}],
  [{lat: 43.43614878714412, lng: -81.18443079990305},{lat: 43.442732327181325, lng: -79.95473707648978}],
  [{lat: 43.43165721072352, lng: -81.18443079990305},{lat: 43.438240750760734, lng: -79.95473707648978}],
  [{lat: 43.42716563430292, lng: -81.18443079990305},{lat: 43.433749174340136, lng: -79.95473707648978}],
  [{lat: 43.42267405788233, lng: -81.18443079990305},{lat: 43.42925759791953, lng: -79.95473707648978}],
  [{lat: 43.418182481461734, lng: -81.18443079990305},{lat: 43.42476602149893, lng: -79.95473707648978}],
  [{lat: 43.413690905041136, lng: -81.18443079990305},{lat: 43.420274445078334, lng: -79.95473707648978}],
  [{lat: 43.40919932862054, lng: -81.18443079990305},{lat: 43.41578286865773, lng: -79.95473707648978}],
  [{lat: 43.40470775219995, lng: -81.18443079990305},{lat: 43.411291292237145, lng: -79.95473707648978}],
  [{lat: 43.40021617577935, lng: -81.18443079990305},{lat: 43.40679971581655, lng: -79.95473707648978}],
  [{lat: 43.39572459935874, lng: -81.18443079990305},{lat: 43.40230813939594, lng: -79.95473707648978}],
  [{lat: 43.391233022938145, lng: -81.18443079990305},{lat: 43.39781656297534, lng: -79.95473707648978}],
  [{lat: 43.38674144651755, lng: -81.18443079990305},{lat: 43.39332498655476, lng: -79.95473707648978}],
  [{lat: 43.382249870096956, lng: -81.18443079990305},{lat: 43.388833410134154, lng: -79.95473707648978}],
  [{lat: 43.37775829367636, lng: -81.18443079990305},{lat: 43.38434183371356, lng: -79.95473707648978}],
  [{lat: 43.37326671725576, lng: -81.18443079990305},{lat: 43.37985025729296, lng: -79.95473707648978}],
  [{lat: 43.368775140835155, lng: -81.18443079990305},{lat: 43.37535868087237, lng: -79.95473707648978}],
  [{lat: 43.36428356441457, lng: -81.18443079990305},{lat: 43.37086710445176, lng: -79.95473707648978}],
  [{lat: 43.359791987993965, lng: -81.18443079990305},{lat: 43.36637552803116, lng: -79.95473707648978}],
  [{lat: 43.35530041157337, lng: -81.18443079990305},{lat: 43.361883951610565, lng: -79.95473707648978}],
  [{lat: 43.35080883515277, lng: -81.18443079990305},{lat: 43.35739237518997, lng: -79.95473707648978}],
  [{lat: 43.34631725873217, lng: -81.18443079990305},{lat: 43.352900798769376, lng: -79.95473707648978}],
  [{lat: 43.341825682311566, lng: -81.18443079990305},{lat: 43.34840922234878, lng: -79.95473707648978}],
  [{lat: 43.33733410589098, lng: -81.18443079990305},{lat: 43.34391764592818, lng: -79.95473707648978}],
  [{lat: 43.33284252947038, lng: -81.18443079990305},{lat: 43.339426069507574, lng: -79.95473707648978}],
  [{lat: 43.32835095304978, lng: -81.18443079990305},{lat: 43.334934493086976, lng: -79.95473707648978}],
  [{lat: 43.32385937662919, lng: -81.18443079990305},{lat: 43.33044291666639, lng: -79.95473707648978}],
  [{lat: 43.31936780020858, lng: -81.18443079990305},{lat: 43.325951340245794, lng: -79.95473707648978}],
  [{lat: 43.31487622378799, lng: -81.18443079990305},{lat: 43.321459763825196, lng: -79.95473707648978}],
  [{lat: 43.31038464736739, lng: -81.18443079990305},{lat: 43.31696818740458, lng: -79.95473707648978}],
  [{lat: 43.305893070946794, lng: -81.18443079990305},{lat: 43.31247661098399, lng: -79.95473707648978}],
  [{lat: 43.30140149452619, lng: -81.18443079990305},{lat: 43.30798503456339, lng: -79.95473707648978}],
  [{lat: 43.29690991810559, lng: -81.18443079990305},{lat: 43.3034934581428, lng: -79.95473707648978}],
  [{lat: 43.292418341685, lng: -81.18443079990305},{lat: 43.2990018817222, lng: -79.95473707648978}],
  [{lat: 43.2879267652644, lng: -81.18443079990305},{lat: 43.29451030530161, lng: -79.95473707648978}],
  [{lat: 43.2834351888438, lng: -81.18443079990305},{lat: 43.290018728881, lng: -79.95473707648978}],
  [{lat: 43.278943612423205, lng: -81.18443079990305},{lat: 43.28552715246041, lng: -79.95473707648978}],
  [{lat: 43.274452036002614, lng: -81.18443079990305},{lat: 43.281035576039805, lng: -79.95473707648978}],
  [{lat: 43.26996045958201, lng: -81.18443079990305},{lat: 43.276543999619214, lng: -79.95473707648978}],
  [{lat: 43.26546888316142, lng: -81.18443079990305},{lat: 43.272052423198616, lng: -79.95473707648978}],
  [{lat: 43.26097730674081, lng: -81.18443079990305},{lat: 43.26756084677801, lng: -79.95473707648978}],
  [{lat: 43.25648573032023, lng: -81.18443079990305},{lat: 43.26306927035743, lng: -79.95473707648978}],
  [{lat: 43.25199415389963, lng: -81.18443079990305},{lat: 43.25857769393682, lng: -79.95473707648978}],
  [{lat: 43.24750257747903, lng: -81.18443079990305},{lat: 43.25408611751622, lng: -79.95473707648978}],
  [{lat: 43.24301100105843, lng: -81.18443079990305},{lat: 43.249594541095625, lng: -79.95473707648978}],
  [{lat: 43.23851942463782, lng: -81.18443079990305},{lat: 43.245102964675034, lng: -79.95473707648978}],
  [{lat: 43.234027848217224, lng: -81.18443079990305},{lat: 43.240611388254436, lng: -79.95473707648978}],
  [{lat: 43.22953627179663, lng: -81.18443079990305},{lat: 43.23611981183383, lng: -79.95473707648978}],
  [{lat: 43.225044695376035, lng: -81.18443079990305},{lat: 43.23162823541323, lng: -79.95473707648978}],
  [{lat: 43.22055311895543, lng: -81.18443079990305},{lat: 43.227136658992634, lng: -79.95473707648978}],
  [{lat: 43.21606154253484, lng: -81.18443079990305},{lat: 43.22264508257204, lng: -79.95473707648978}],
  [{lat: 43.21156996611425, lng: -81.18443079990305},{lat: 43.218153506151445, lng: -79.95473707648978}],
  [{lat: 43.20707838969365, lng: -81.18443079990305},{lat: 43.21366192973085, lng: -79.95473707648978}],
  [{lat: 43.202586813273044, lng: -81.18443079990305},{lat: 43.20917035331025, lng: -79.95473707648978}],
  [{lat: 43.198095236852446, lng: -81.18443079990305},{lat: 43.204678776889644, lng: -79.95473707648978}],
  [{lat: 43.19360366043185, lng: -81.18443079990305},{lat: 43.200187200469045, lng: -79.95473707648978}],
  [{lat: 43.18911208401125, lng: -81.18443079990305},{lat: 43.19569562404846, lng: -79.95473707648978}],
  [{lat: 43.18462050759066, lng: -81.18443079990305},{lat: 43.191204047627856, lng: -79.95473707648978}],
  [{lat: 43.18012893117007, lng: -81.18443079990305},{lat: 43.18671247120725, lng: -79.95473707648978}],
  [{lat: 43.175637354749455, lng: -81.18443079990305},{lat: 43.18222089478666, lng: -79.95473707648978}],
  [{lat: 43.171145778328864, lng: -81.18443079990305},{lat: 43.17772931836607, lng: -79.95473707648978}],
  [{lat: 43.16665420190826, lng: -81.18443079990305},{lat: 43.17323774194547, lng: -79.95473707648978}],
  [{lat: 43.162162625487674, lng: -81.18443079990305},{lat: 43.16874616552487, lng: -79.95473707648978}],
  [{lat: 43.157671049067076, lng: -81.18443079990305},{lat: 43.164254589104274, lng: -79.95473707648978}],
  [{lat: 43.15317947264647, lng: -81.18443079990305},{lat: 43.15976301268367, lng: -79.95473707648978}],
  [{lat: 43.14868789622587, lng: -81.18443079990305},{lat: 43.155271436263085, lng: -79.95473707648978}],
  [{lat: 43.14419631980528, lng: -81.18443079990305},{lat: 43.15077985984248, lng: -79.95473707648978}],
  [{lat: 43.139704743384684, lng: -81.18443079990305},{lat: 43.14628828342188, lng: -79.95473707648978}],
  [{lat: 43.13521316696408, lng: -81.18443079990305},{lat: 43.14179670700128, lng: -79.95473707648978}],
  [{lat: 43.13072159054348, lng: -81.18443079990305},{lat: 43.13730513058069, lng: -79.95473707648978}],
  [{lat: 43.12623001412288, lng: -81.18443079990305},{lat: 43.13281355416009, lng: -79.95473707648978}],
  [{lat: 43.12173843770229, lng: -81.18443079990305},{lat: 43.128321977739496, lng: -79.95473707648978}],
  [{lat: 43.11724686128169, lng: -81.18443079990305},{lat: 43.1238304013189, lng: -79.95473707648978}],
  [{lat: 43.1127552848611, lng: -81.18443079990305},{lat: 43.11933882489829, lng: -79.95473707648978}],
  [{lat: 43.1082637084405, lng: -81.18443079990305},{lat: 43.1148472484777, lng: -79.95473707648978}],
  [{lat: 43.10377213201989, lng: -81.18443079990305},{lat: 43.11035567205711, lng: -79.95473707648978}],
  [{lat: 43.0992805555993, lng: -81.18443079990305},{lat: 43.105864095636505, lng: -79.95473707648978}],
  [{lat: 43.094788979178695, lng: -81.18443079990305},{lat: 43.1013725192159, lng: -79.95473707648978}],
  [{lat: 43.090297402758104, lng: -81.18443079990305},{lat: 43.096880942795316, lng: -79.95473707648978}],
  [{lat: 43.0858058263375, lng: -81.18443079990305},{lat: 43.09238936637472, lng: -79.95473707648978}],
  [{lat: 43.0813142499169, lng: -81.18443079990305},{lat: 43.08789778995411, lng: -79.95473707648978}],
  [{lat: 43.076822673496316, lng: -81.18443079990305},{lat: 43.083406213533515, lng: -79.95473707648978}],
  [{lat: 43.07233109707571, lng: -81.18443079990305},{lat: 43.078914637112916, lng: -79.95473707648978}]
]

// Start writing Firebase Functions
// https://firebase.google.com/docs/functions/typescript
const googleMapsClient = gmap.createClient({
  key: 'AIzaSyChNp26bxuiShNlfPPoWsNlfXCZtCFeZEo',
  Promise: Promise
});

let requestEle = (arr) => {
  return googleMapsClient.elevationAlongPath({
    path: arr,
    samples: 200
  })
  .asPromise()
  .then((responses) => {
    console.log('responses: ' + responses.json.results)
    return responses.json.results
  })
  .catch((err) => {
    console.log(err);
  })
}

let sleep = ms => new Promise(resolve => setTimeout(resolve, ms))

// let delayMap = async (ms, arr) => {
//   const results = []
//   for (const item of arr) {
//     results.push(await requestEle(item))
//     await sleep(ms)
//   }
//   return results
// }

// let loadtesting = () => {
//   return delayMap(4000, testingData)
//     .then(Promise.all.bind(Promise))
//     .then(results => {
//       console.log('the results is : ' + results);
//       return results
//     })
//     .catch(err => console.log(err))
// }


/* Express with CORS & automatic trailing '/' solution */
const app = express()
app.use(cors({ origin: true }));
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());
app.post("*", async (request, response) => {
  try {
    let result =[];
    console.log('start');
    result = [...result, await requestEle(testingData[0])];
    result = [...result , await requestEle(testingData[1])];
    console.log('wait')
    // await sleep(4000);
    result = [...result, await requestEle(testingData[2])];
    // result = [...result, await requestEle(testingData[3])];
    // result = [...result, await requestEle(testingData[4])];
    console.log('final result: ' + result.length)
    response.json(result);
  } catch(error) {
    console.log(error);
  }
})

// not as clean, but a better endpoint to consume
const api = functions.https.onRequest((request, response) => {
  console.log('request item: ' + request);
  if (!request.path) {
    request.url = `/${request.url}` // prepend '/' to keep query params if any
  }
  return app(request, response)
})

module.exports = {
  api
}